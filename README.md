Complete linear algebra: theory and implementation in code